---
updated_at: 2025-12-15T15:50:59.742+10:00
---
Агрегат — это тоже [[Entity|сущность]]: для него требуется явное поле идентификации, и **ожидается, что его состояние** в течение жизненного цикла экземпляра **будет изменяться.** Но это куда более широкое понятие, чем просто сущность. Целью этого паттерна является защита согласованности его данных. Он объединяет бизнес-сущности и [[ValueObject|объекты-значения]], находящиеся в рамках одной и той же границы транзакции.

Агрегат является [[Bounded Context|границей обеспечения согласованности]]. Логика агрегата должна проверять все входящие модификации и гарантировать непротиворечивость изменений его бизнес-правилам. В состав агрегата должна входить только та информация, которая требуется по бизнес-логике агрегата для строгой согласованности данных. Аггрегаты инкапсулируют инварианты, уменьшая таким образом сложность и  [[Степень свободы]]
**Изменять состояние агрегата могут исключительно его собственные методы.** Всем внешним по отношению к агрегату процессам или объектам разрешено только лишь чтение состояния агрегата. 

```go

aggregate.SetName(name string)
//или
aggregate.DoAction(complexActionConfig struct) error

```

Аггрегат является входной точкой для манипуляции его потрохами. Его методы должны быть потокобезопасными ([Mutex]).

Агрегат также действует как границы транзакции. Все изменения состояния агрегата должны быть зафиксированы транзакцией, т. е. одной [[Active Transaction|атомарной операцией]]. 

Для поддержки изменений сразу нескольких объектов, которые должны быть применены в рамках одной атомарной транзакции, паттерн агрегата уподобляется иерархии сущностей. Агрегат не может хранить другие агрегаты, но может хранить их индентификаторы.

Следует придерживаться того правила, чтобы агрегаты были как можно меньше и включали только те объекты, которые в соответствии с бизнес-логикой агрегата должны находиться в строго согласованном состоянии. 

Агрегаты могут спаунить события ([[Domain Event]]) - как способ общения с внешним миром. Другие компоненты могут подписываться на события и использовать их для запуска действий бизнес-логики. 

Агрегаты должны отражать [[Ubiquitous Language|единый язык]]. Термины, используемые для имени агрегата должны быть сформулированы на едином языке ограниченного контекста.