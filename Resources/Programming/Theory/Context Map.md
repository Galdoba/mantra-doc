---
updated_at: 2026-02-12T14:46:25.605+10:00
---
**Карта контекстов** ({{Context Map|context map}}) — это стратегический артефакт [[Domain-Driven Design|предметно-ориентированного проектирования]] (DDD), представляющий собой модель отношений между [[Bounded Context|ограниченными контекстами]] системы. Карта фиксирует существующие границы, способы интеграции и характер взаимодействия между контекстами, а также отражает организационные договорённости команд, владеющих этими контекстами.

Карта контекстов не является диаграммой в строгом смысле; это скорее документированное знание о том, как различные модели предметной области соотносятся друг с другом в реально работающей системе.

### Назначение
Построение и поддержание карты контекстов решает ключевые задачи стратегического проектирования:

*   **Визуализация архитектуры**. Обеспечивает целостное представление о декомпозиции системы, позволяя увидеть все ограниченные контексты и их взаимосвязи на одном уровне абстракции.
*   **Фиксация интеграционных паттернов**. Документирует, какие именно отношения сложились между контекстами: партнёрство, разделяемое ядро, поставщик-клиент, конформист, уровень защиты от повреждений, открытый сервис, опубликованный язык, раздельные пути.
*   **Координация команд**. Служит основой для согласования интерфейсов и протоколов между командами, а также для выявления зон ответственности и зависимостей.
*   **Обнаружение проблем**. Помогает выявить неоправданно сильные связи («распределённый монолит»), отсутствие явных контрактов, дублирование ответственности или изолированные «островки» без интеграции.
*   **Планирование эволюции**. Позволяет оценить влияние изменений в одном контексте на другие и спланировать поэтапную миграцию или выделение новых контекстов.

### Ограничения
Применение карт контекстов сопряжено с рядом ограничений и рисков:

1.  **Статичность**. Карта представляет собой снимок состояния на момент документирования и быстро устаревает, если не поддерживается актуальной. В быстро меняющихся системах поддержание карты требует постоянных усилий.
2.  **Субъективность**. Определение границ и классификация отношений зависят от интерпретации участников; разные команды могут по-разному видеть один и тот же контекст.
3.  **Сложность масштабирования**. В крупных организациях с десятками или сотнями контекстов единая карта становится перегруженной и теряет наглядность.
4.  **Недостаточная детализация**. Карта фиксирует лишь факт и тип связи, но не описывает динамику обмена данными, частоту вызовов, протоколы и форматы сообщений.
5.  **Сопротивление документированию**. Команды часто считают построение карты «бумажной работой», не приносящей немедленной ценности, и пренебрегают её обновлением.

### Сложившиеся практики
Индустрия выработала устойчивые подходы к созданию, поддержанию и использованию карт контекстов:

1.  **Идентификация ограниченных контекстов**. Первым шагом является выявление всех контекстов в системе. Источниками служат: организационная структура (команды), кодовая база (модули, пакеты, сервисы), обсуждения с экспертами и существующая документация.

2.  **Документирование отношений**. Для каждой пары взаимодействующих контекстов определяется тип отношений. В DDD описаны восемь стандартных паттернов:
    *   **[[Partnership|Партнёрство]]** — две команды координируют изменения и совместно развивают границу.
    *   **[[Shared Kernel|Разделяемое ядро]]** — общая подмножество модели, согласованная обеими командами.
    *   **[[Customer-Supplier|Поставщик-клиент]]** — вышестоящий контекст определяет модель, нижестоящий подстраивается.
    *   **[[Conformist|Конформист]]** — строгое следование модели вышестоящего контекста без попыток влияния.
    *   **[[Anticorruption Layer|Уровень защиты от повреждений]]** — прослойка, преобразующая модель одного контекста в модель другого, предотвращая «заражение» чужеродными концепциями.
    *   **[[Open-Host Service|Открытый сервис]]** — публичный интерфейс, предоставляемый контекстом для внешних потребителей.
    *   **[[Published Language|Опубликованный язык]]** — формализованный протокол взаимодействия, задокументированный и доступный всем.
    *   **[[Separate Ways|Раздельные пути]]** — полная независимость, интеграция отсутствует.

3.  **Визуализация**. Карта представляется в наглядной графической форме: контексты изображаются как прямоугольники, отношения — как линии с соответствующими аннотациями или цветовой кодировкой. Инструменты могут варьироваться от досок и маркеров до специализированных решений (Context Mapper, Structurizr).

4.  **Хранение рядом с кодом**. Карта контекстов не должна существовать в отрыве от разрабатываемого продукта. Практика размещения описания контекстов в [[ADL|архитектурных документах]] (Architecture Decision Records) или непосредственно в репозитории в текстовом формате (AsciiDoc, Markdown) повышает вероятность её поддержания.

5.  **Связь с исходным кодом**. Современные подходы позволяют аннотировать код метками, указывающими принадлежность к определённому контексту, и генерировать карту автоматически. Инструменты статического анализа могут выявлять фактические связи и сопоставлять их с декларированными.

6.  **Итеративное уточнение**. Карта не создаётся однократно; она уточняется по мере углубления понимания предметной области и изменений в архитектуре. Каждое значительное изменение отношений между командами или сервисами должно отражаться в карте.

7.  **Использование на стратегических встречах**. Карта контекстов является обязательным артефактом при планировании крупных изменений, реорганизации команд или выборе интеграционных технологий. Она служит общим языком для технических специалистов и менеджеров.

8.  **Разделение по уровням**. В очень больших системах карта строится иерархически: верхний уровень показывает только основные контексты и их отношения, каждый контекст может быть детализирован внутренней картой подконтекстов или модулей.

9.  **Автоматическая проверка согласованности**. Инструменты могут проверять, соответствуют ли задокументированные отношения реальным вызовам в коде: например, наличие ACL там, где заявлен уровень защиты, или отсутствие прямых вызовов между контекстами с типом «раздельные пути».

10. **Обучение новых членов команды**. Карта контекстов служит первичным материалом для погружения в архитектуру, позволяя новым разработчикам быстро понять, какие части системы существуют и как они взаимодействуют.

Таким образом, карта контекстов является не просто диаграммой, а дисциплинированным способом управления знанием о стратегической структуре системы. Её ценность определяется не столько художественной выразительностью, сколько точностью отражения реальных отношений и активным использованием в процессе принятия архитектурных и организационных решений.