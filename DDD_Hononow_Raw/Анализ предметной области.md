---
updated_at: 2025-12-11T12:14:44.143+10:00
tags:
  - part1
  - chapter1
---
Если вы хоть чем-то похожи на меня, то любите писать код: решать сложные проблемы, придумывать элегантные решения и создавать совершенно новые миры, тщательно прорабатывая их правила, структуры и поведение. Возможно, именно это вас и заинтересовало в предметно-ориентированном проектировании (domaindriven design — DDD) и вы хотите повысить свою квалификацию. Но эта глава совсем не о создании кода. В ней говорится о том, как работают компании: почему они существуют, какие цели преследуют и каковы их стратегии для достижения поставленных целей. 
Когда этот материал преподается на моих уроках по предметно-ориентированному проектированию, многие студенты спрашивают: «А надо ли нам это? Мы ведь программисты, а не бизнесмены». Ответ — твердое «да». Для эффективной выработки решения, создания проекта и его реализации нужно четкое понимание задачи. В нашем контексте задачей является подлежащая созданию программная система. Чтобы понять суть задачи, нужно разобраться в среде ее существования, т. е. в бизнес-стратегии организации и в той выгоде, которую она стремится получить от создания программного продукта. 
В этой главе будут рассмотрены инструменты предметно-ориентированного проектирования, предназначенные для анализа предметной области (domain) компании и ее структуры: ее основных, вспомогательных и универсальных поддоменов (subdomain). Этот материал служит основой для разработки программных продуктов. В остальных главах будут показаны различные пути влияния рассматриваемых концепций на разработку программных систем.

## Так что же такое предметная область?
Предметная область определяет основную сферу деятельности компании. Проще говоря, это сервис, предоставляемый компанией своим клиентам. Например:

- FedEx предоставляет курьерскую доставку. 
- Starbucks больше известна своим кофе. 
- Walmart — одна из самых известных сетей розничной торговли.

Компания может работать сразу в нескольких областях бизнеса. Например, Amazon предоставляет как тиражируемые, так и облачные услуги. Uber — компания, занимающаяся райдшерингом, которая также предоставляет услуги по доставке еды и прокату велосипедов.
Важно отметить, что компании могут весьма часто менять сферу деятельности. Каноническим примером этого является компания Nokia, на протяжении многих лет работавшая в таких разных областях, как деревообработка, производство каучука, телекоммуникации и мобильная связь.

## Что такое поддомен (subdomain)?
Чтобы достичь целей и задач в своей предметной области, компания должна работать в нескольких поддоменах. Поддомен — это четко определенная область деловой активности. Из всех поддоменов образуется предметная область компании: те самые услуги, которые она предоставляет своим клиентам. Реализации только одного поддомена недостаточно для успеха компании, поскольку им представлен всего лишь один строительный блок общей системы. Чтобы компания смогла достичь поставленных целей в своей сфере деятельности, поддомены должны взаимодействовать друг с другом. Например, компания Starbucks, наверное, более известна своим кофе, но для создания успешной сети кофеен требуется нечто большее, чем простое умение готовить отличный кофе. Среди прочего нужно также приобретать или брать в аренду недвижимость в выгодных местах, нанимать персонал и управлять финансами. Сам по себе ни один из этих поддоменов не перерастет в прибыльную компанию. Но их совокупность необходима, чтобы компания могла конкурировать в своей предметной области (или областях) бизнеса.

### Типы поддоменов
По аналогии с тем, как программная система включает в себя различные архитектурные компоненты — базы данных, интерфейсные приложения, серверные службы и т. д., — поддомены привносят различные стратегические или же бизнесценности. В предметно-ориентированном проектировании различают три типа поддоменов: основные (core), универсальные (generic) и вспомогательные (supporting). Давайте посмотрим, чем они отличаются друг от друга с позиции стратегии компании.

#### Основные поддомены (core subdomains) 
Основной поддомен — это то, что отличает деятельность компании от деятельности ее конкурентов. Сюда можно отнести изобретение новых продуктов или услуг или же снижение затрат за счет оптимизации существующих процессов. 
Возьмем, к примеру, компанию Uber. Изначально компания предлагала новый вид транспортных услуг: райдшеринг. По мере того как ее догоняли конкуренты, Uber находила способы оптимизации и развития своего основного бизнеса: например, снижая расходы за счет подбора пассажиров, следующих в одном направлении. 
Основные поддомены Uber влияют на ее прибыль. Этим компания отличается от своих конкурентов. Это стратегия компании по улучшению обслуживания клиентов и (или) достижения максимальной прибыли. Чтобы сохранить конкурентное преимущество, основные поддомены включают изобретения, продуманные оптимизации, бизнес ноу-хау или другую интеллектуальную собственность.
Рассмотрим другой пример: алгоритм ранжирования поиска Google. На момент написания книги на рекламную платформу Google приходилась основная часть прибыли этой компании. И тем не менее Google Ads — не поддомен, а скорее отдельная предметная область с составляющими ее поддоменами, среди которых службы облачных вычислений (Google Cloud Platform), инструменты для повышения производительности и совместной работы (Google Workspaces) и другие области, в которых работает компания Alphabet, ставшая для Google ее родительской компанией. А как насчет поиска Google и его алгоритма ранжирования? Хотя поисковая система не является платной услугой, она служит крупнейшей платформой отображения для Google Ads. Ее способность предоставлять отличные результаты поиска — это то, что привлекает трафик и, следовательно, представляет собой весьма важный компонент рекламной платформы. Выдача неоптимальных результатов поиска из-за ошибок в алгоритме или наличие конкурента, предлагающего более качественный поисковый сервис, нанесет ущерб доходам рекламного бизнеса. Получается, что для Google алгоритм ранжирования — это основной поддомен (core subdomain). 
**Сложность (complexity).** Основной поддомен, который довольно легко реализовать, может обеспечить лишь кратковременное конкурентное преимущество. Следовательно, основным поддоменам присуща сложность. Продолжая пример с компанией Uber, следует отметить, что она не только создала новое рыночное пространство с райдшерингом, но и разрушила многолетнюю монолитную архитектуру индустрии такси за счет целенаправленного использования технологий. Досконально разобравшись в сфере своей деятельности, компания Uber смогла разработать более надежный и прозрачный способ перевозки клиентов. У основного бизнеса компании должен быть более высокий входной порог, чтобы конкурентам было сложно скопировать или сымитировать решение компании. 
**Источники конкурентного преимущества.** Важно отметить, что основные поддомены могут быть и не технологической направленности. Не все бизнес-задачи решаются с помощью алгоритмов или других технических решений. Конкурентное преимущество компании может исходить из разных источников. 
Рассмотрим, к примеру, производителя ювелирных изделий, торгующего ими через Интернет. Интернет-магазин является важным, но не основным поддоменом. Здесь основное — разработка дизайна украшений. Компания может воспользоваться готовым движком интернет-магазина, но не в состоянии отдать дизайн своих украшений на аутсорсинг. Именно дизайн привлекает покупателей к продукции производителя ювелирных изделий и способствует запоминанию бренда. 
Рассмотрим пример посложнее, представив себе компанию, специализирующуюся на неавтоматизированном вскрытии случаев мошенничества. Компания учит своих аналитиков просмотру сомнительных документов и выявлению потенциальных случаев мошенничества. Вам предстоит создать программную систему, с которой будут работать аналитики. Это основной поддомен? Нет. Основным является работа аналитиков. Создаваемая вами система не имеет ничего общего с анализом мошенничества, она просто отображает документы и отслеживает комментарии аналитиков.

---
**Отличие основного поддомена от основного домена (предметной области)**
Основные поддомены называют также основными предметными областями (доменами). Например, в исходной книге по предметно-ориентированному проектированию Эрик Эванс (Eric Evans) использует понятия «основной поддомен и «основная предметная область» как синонимы. Хотя понятие «основная предметная область» используется довольно часто, я по ряду причин предпочитаю использовать понятие «основной поддомен». 
Во-первых, это действительно поддомен, и я стараюсь не путать его с предметной областью. 
Во-вторых, *в главе 11* будет показано, что поддомены со временем эволюционируют и меняют свой тип. Например, основной поддомен (core subdomain) может превратиться в универсальный (generic). Следовательно, сказать, что «универсальный (generic) поддомен стал основным (core) поддоменом», проще, чем сказать, что «обычный поддомен превратился в основную предметную область (домен)».

---

#### Универсальные поддомены (generic subdomains) 
Универсальные поддомены относятся к той бизнес-деятельности, которую все компании выполняют одинаково. Как и основные поддомены, универсальные поддомены, как правило, сложны и труднореализуемы. Но универсальные поддомены не дают компании никаких конкурентных преимуществ. Они не отличаются инновациями или оптимизациями и характеризуются проверенными на практике реализациями, имеющими широкий доступ и применяемыми всеми компаниями. 
Например, в большинстве систем предусматривается обязательная аутентификация и авторизация пользователей. Вместо изобретения собственного механизма аутентификации есть смысл использовать уже существующее решение, которое, скорее всего, будет более надежным и безопасным, поскольку оно уже было испробовано многими другими компаниями с аналогичными потребностями. 
Если вернуться к нашему примеру с производителем ювелирных изделий, торгующим через Интернет, дизайн ювелирных изделий является основным поддоменом, а интернет-магазин — универсальным поддоменом. Использование для розничной торговли такой же онлайн-платформы, т. е. того же универсального решения, что и у конкурентов, не повлияет на конкурентное преимущество нашего производителя.

#### Вспомогательные поддомены (supporting subdomains) 
Судя по названию, вспомогательные поддомены поддерживают бизнес компании. Но, в отличие от основных поддоменов (core subdomains), вспомогательные подобласти не дают никаких конкурентных преимуществ. 
Рассмотрим, к примеру, работу компании, занимающейся онлайн-рекламой, основные поддомены которой включают подбор рекламы для посетителей, повышение эффективности рекламы и сведение к минимуму стоимости рекламного места. Но для успеха в этих областях компании необходимо создать каталог своих наработок.
Порядок хранения и индексации физических наработок, например баннеров и открывающихся по ссылке рекламных страниц, не влияет на ее прибыль. В этой области ничего изобретать или оптимизировать не нужно. С другой стороны, каталог наработок необходим для реализации системы управления рекламой и вспомогательных систем. Следовательно, решение по каталогизации контента становится одним из вспомогательных поддоменов компании. 
Вспомогательные поддомены отличает сложность бизнес-логики решения. Сами по себе эти поддомены весьма просты. А их бизнес-логика в основном напоминает экраны ввода данных и ETL-операции (извлечение, преобразование, загрузка): т. е. завязана на так называемые CRUD-интерфейсы (создание, чтение, обновление и удаление). Эти сферы деятельности не дают компании никаких конкурентных преимуществ и поэтому не требуют высоких входных барьеров.

### Сравнение поддоменов 
Итак, получив более полное представление о трех типах поддоменов, самое время рассмотреть их различия с иных позиций и понять, как они влияют на стратегические решения по проектированию программных продуктов.

#### Конкурентное преимущество 
Конкурентное преимущество обеспечивается компаниям только основными поддоменами (core subdomains). Эти поддомены составляют стратегию компании, направленную на то, чтобы выделиться среди конкурентов. 
Универсальные поддомены (generic subdomains) по определению не могут быть источником каких-либо конкурентных преимуществ. Это обычные решения, используемые компанией и ее конкурентами. 
У вспомогательных поддоменов (supporting subdomains) низкие входные барьеры, и они не могут обеспечить конкурентное преимущество. Обычно компания не возражает против того, чтобы ее конкуренты копировали вспомогательные поддомены, поскольку это никак не повлияет на ее конкурентоспособность в их отрасли. Наоборот, стратегически компания предпочла бы, чтобы вспомогательные поддомены были универсальными готовыми решениями, что избавит от необходимости заниматься их разработкой и реализацией. Более подробно случаи превращения вспомогательных поддоменов в универсальные, а также другие возможные перестановки будут рассмотрены в *главе 11*. Практический пример подобного сценария будет приведен в *приложении 1*. 
Чем сложнее задачи, успешно решаемые компанией, тем более высокой будет предоставляемая ей бизнес-ценность. Сложные задачи не ограничиваются предоставлением услуг потребителям, они могут заключаться, например, в оптимизации и повышении эффективности бизнеса. К примеру, конкурентным преимуществом также является предоставление того же уровня обслуживания, что и у конкурентов, но с меньшими эксплуатационными расходами.

#### Сложность 
Определить поддомены организации важно и в сугубо техническом плане, поскольку разные типы поддоменов имеют разные уровни сложности. При разработке программных продуктов нужно выбирать инструменты и методы, соответствующие сложности бизнес-требований. Следовательно, определение поддоменов необходимо для разработки надежного программного решения. 
Бизнес-логика вспомогательных поддоменов (supporting subdomains) не слишком сложна для понимания. Для базовых ETL-операций и CRUD-интерфейсов она совершенно очевидна и зачастую не выходит за рамки проверки входных данных или преобразования данных из одной структуры в другую. 
Универсальные поддомены (generic subdomains) намного сложнее. Недаром на решение присущих им задач другими организациями уже было потрачено немало времени и усилий. И эти решения были далеко не простыми. Достаточно, к примеру, вспомнить об алгоритмах шифрования или о механизмах аутентификации. 
С позиции доступности знаний универсальные поддомены можно назвать «известными неизвестными». О них известно, что ничего не известно. А соответствующие знания находятся в открытом доступе. Можно воспользоваться либо тем передовым опытом, который принят в вашей сфере деятельности, либо, в случае необходимости, нанять консультанта, специализирующегося в этой области, который разработает индивидуальное решение. 
Основные поддомены (core subdomains) отличаются особой сложностью. Их копирование конкурентами должно быть максимально затруднено, поскольку от этого зависит прибыльность компании. Вот почему стратегически компании стремятся решать сложные задачи в рамках своих основных поддоменов. 
Порой отличить основные поддомены от вспомогательных довольно трудно. Здесь в качестве отличительной черты следует руководствоваться степенью сложности. Нужно задаться вопросом: может ли рассматриваемый поддомен стать побочным бизнесом? Будет ли кто-то с готовностью платить за это? Если да, то это основной поддомен. Аналогичные рассуждения справедливы к разграничению вспомогательных и универсальных поддоменов: а не проще ли будет создать собственную реализацию, чем интегрировать в свою работу стороннее решение? Если да, то это будет вспомогательный поддомен. 
С сугубо технической точки зрения важно определить основные поддомены, сложность которых повлияет на разработку программного продукта. Ранее уже говорилось, что основной поддомен может быть и не связан с программным обеспечением. Еще один ведущий принцип определения основных поддоменов, связанных с программным обеспечением, заключается в оценке сложности бизнес-логики, которую придется моделировать и воплощать в программном коде. Будет ли она чемто вроде бизнес-логики CRUD-интерфейсов для ввода данных, или же придется заняться реализацией сложных алгоритмов или бизнес-процессов, управляемых замысловатыми бизнес-правилами и инвариантами? В первом случае это будет признаком вспомогательного поддомена, а во втором — типичным основным поддоменом.
Диаграмма на рис. 1.1 отображает взаимодействие трех типов поддоменов с позиции бизнес-дифференциации и сложности бизнес-логики. Пересечение между вспомогательными и универсальными поддоменами находится в темно-серой зоне: оно может идти в любом направлении. Если для поддержки функций поддомена существует общее решение, то тип этого поддомена определяется в зависимости от того, насколько проще и (или) дешевле встроить это решение, чем создать функцию с нуля.

![[Рис. 1.1. Бизнес-дифференциации и сложность бизнес-логики трех типов подобластей.png]]

#### Изменчивость 
Основные поддомены, как уже выяснилось, могут часто меняться. Если проблему можно решить с первой попытки, то это, наверное, не будет считаться серьезным конкурентным преимуществом, поскольку конкуренты быстро наверстают упущенное. Следовательно, появятся решения для основных поддоменов. Весь спектр реализаций должен быть опробован, усовершенствован и оптимизирован. Более того, работа над основными поддоменами никогда не завершается. Компании постоянно внедряют инновации и развивают основные поддомены. Изменения выражаются в добавлении новых функций или в оптимизации существующей функциональности. В любом случае постоянное развитие основных поддоменов необходимо компании, чтобы обогнать конкурентов. 
В отличие от основных поддоменов, вспомогательные поддомены не подвержены частым изменениям. Они не дают компании никаких конкурентных преимуществ, и поэтому развитие вспомогательного поддомена приносит ничтожную коммерческую ценность по сравнению с теми же усилиями, вложенными в основной поддомен. 
Несмотря на уже имеющиеся готовые решения, универсальные поддомены могут со временем изменяться. Могут совершенствоваться меры безопасности, исправляться ошибки или внедряться совершенно новые решения их проблем.

#### Стратегия решения (solution) 
Основные поддомены позволяют компании конкурировать с другими игроками в ее сфере деятельности. Успешная конкуренция очень важна для бизнеса, но означает ли это, что вспомогательные и универсальные поддомены для него не важны? Конечно, нет. Для работы компании в избранном бизнесе необходимы все поддомены. Они сродни фундаментальным строительным блокам: уберите один, и может рухнуть вся структура. И чтобы выбрать стратегии реализации для наиболее эффективного создания поддоменов каждого типа, можно воспользоваться свойствами, присущими различным типам поддоменов. 
Основные поддомены должны реализовываться в самой компании. Их нельзя приобрести или позаимствовать, поскольку это подорвало бы само понятие конкурентного преимущества, т. к. конкуренты компании могли бы сделать то же самое. 
Также было бы неразумно отдавать реализацию основного поддомена на аутсорсинг. Это стратегическая инвестиция. Экономия на основном поддомене рискованна не только в краткосрочной перспективе, но может иметь фатальные последствия и в будущем: можно, к примеру, утратить поддержку разработанного сторонней организацией программного кода, а вместе с этим и поддержку целей и задач компании. Для работы над основными поддоменами компании нужно назначать наиболее квалифицированные кадры. Кроме того, внедрение основных поддоменов с привлечением собственных сил позволяет компании оперативно вносить изменения и развивать решение, а значит, быстрее добиваться конкурентного преимущества. 
Поскольку требования к основным поддоменам склонны к частым и постоянным изменениям, решение должно быть таким, чтобы его было удобно сопровождать и легко развивать. То есть основные поддомены требуют реализации самых передовых методов проектирования. 
Так как универсальные поддомены относятся к разряду сложных, но уже решенных задач, выгоднее купить готовый продукт или взять на вооружение решение с открытым исходным кодом, чем тратить время и ресурсы на реализацию универсального поддомена собственными силами. 
Вспомогательные поддомены не предназначены для создания конкурентных преимуществ, поэтому реализации этих подобластей собственными силами лучше было бы избежать. Но, в отличие от обычных поддоменов, здесь готовых решений не существует. Получается, что у компании нет другого выбора, кроме как взять реализацию вспомогательных поддоменов на себя. И все же простота бизнес-логики и нечастые изменения позволяют на них сэкономить. 
Для вспомогательных поддоменов не нужны сложные паттерны или иные передовые методы проектирования. Для реализации бизнес-логики без непреднамеренных сложностей достаточно будет какой-нибудь среды быстрой разработки приложений. 
С позиции кадрового подхода вспомогательные поддомены для своей разработки не требуют привлечения высококвалифицированных опытных специалистов и предоставляют прекрасную возможность для обучения перспективных талантов. Опытных специалистов лучше приберечь для основных поддоменов. А простота бизнес-логики превращает вспомогательные поддомены в хороших кандидатов на аутсорсинг. 
Аспекты, отличающие три типа поддоменов друг от друга, сведены в табл. 1.1

[[Таблица 1.1. Отличия трех типов поддоменов друг от друга]]

|        Тип поддомена         | Создание конкурентных преимуществ | Сложность | Изменчивость |           Реализация           |   Задача   |
| :--------------------------: | :-------------------------------: | :-------: | :----------: | :----------------------------: | :--------: |
|       Основной (core)        |                Да                 |  Высокая  |   Высокая    |        Самостоятельная         | Интересная |
|   Универсальный (generic)    |                Нет                |  Высокая  |    Низкая    |   Покупка или заимствование    |  Решенная  |
| Вспомогательный (supporting) |                Нет                |  Низкая   |    Низкая    | Самостоятельная или аутсорсинг | Банальная  |

### Определение границ поддоменов 
Уже можно было заметить, что идентификация поддоменов и их типов существенно облегчает принятие различных проектных решений при создании программных продуктов. В последующих главах будут раскрыты и другие способы использования поддоменов для оптимизации процесса проектирования программных средств. Так как же все-таки идентифицировать поддомены и их границы? 
Поддомены и их типы определяются бизнес-стратегией компании: ее предметными областями и тем, как она отличается от других компаний, чтобы конкурировать с ними в той же сфере. Так или иначе, в подавляющем большинстве программных проектов поддомены «уже есть». Но это не означает, что определить их границы будет всегда легко и просто. Если попросить у генерального директора поделиться перечнем поддоменов его компании, то он, наверное, бросит на вас недоуменный взгляд. Ему неизвестно это понятие. Поэтому придется самостоятельно провести анализ своей предметной области и классифицировать действующие в ней поддомены. 
Хорошей отправной точкой являются отделы компании и другие организационные подразделения. К примеру, интернет-магазин розничной торговли может включать в себя, помимо всего прочего, склад, отдел обслуживания клиентов, отдел комплектации, отгрузки, контроля качества и управления каналами сбыта. Но это относительно широкие области деятельности. Если взять только лишь отдел обслуживания клиентов, то разумно будет предположить, что его деятельность будет подпадать под вспомогательный или даже универсальный поддомен, поскольку его функция часто передается сторонним поставщикам. Но будет ли достаточно этой информации для принятия обоснованных решений по проектированию программного продукта?

Выделение поддоменов (Distilling subdomains) 
Грубо заданные поддомены можно считать хорошей отправной точкой, но дьявол кроется в мелочах. Нужно быть уверенным, что не упущена никакая важная информация, скрытая в хитросплетениях бизнес-функции. 
Вернемся к нашему примеру с отделом обслуживания клиентов. Если исследовать его внутреннюю работу, то станет понятно, что типичный отдел обслуживания клиентов состоит из более мелких подразделений: справочной службы, группы управления рабочими сменами и планирования, телефонной станции и т. д. Если рассматривать их как отдельные поддомены, то они могут быть отнесены к разным типам: справочная служба и телефонная станция являются универсальными поддоменами, управление сменами является вспомогательным подоменом, но компания может разработать и свой оригинальный алгоритм маршрутизации обращений к агентам, добившимся успеха в подобных случаях в прошлом. Алгоритм маршрутизации требует анализа входящих обращений и выявления сходства с прошлым опытом — и то и другое является непростой задачей. Поскольку алгоритм маршрутизации позволяет компании обеспечить более качественное обслуживание клиентов по сравнению с ее конкурентами, то этот род деятельности следует отнести к основному поддомену. Соответствующий пример показан на рис. 1.2.

![[Рис. 1.2. Анализ внутреннего механизма предположительно универсального поддомена.png]]

И в то же время нельзя бесконечно углубляться в поисках информации во всё более и более низкие уровни детализации. Но когда все же нужно остановиться?

#### Поддомены с позиции согласующихся сценариев использования 
С технической точки зрения поддомены напоминают наборы взаимосвязанных, согласующихся сценариев использования (use cases), как правило, с одними и теми же участниками, объектами хозяйствования и родственным набором используемых данных. 
Рассмотрим схему сценариев использования по использованию системы приема платежей по кредитным картам, показанную на рис. 1.3. Сценарии тесно связаны с рабочими данными и вовлеченными участниками. Следовательно, все варианты действий формируют поддомен оплаты кредитной картой. 
В качестве ведущего принципа, позволяющего остановить поиск все более мелких поддоменов, можно воспользоваться следующим определением: поддомен — это набор согласующихся сценариев использования. Именно этим определяются наиболее точные границы поддоменов.

![[Рис. 1.3. Диаграмма сценариев использования поддомена оплаты кредитной картой.png]]

Но нужно ли всегда слишком пристально высматривать границы поддоменов? Для основных поддоменов — да, нужно. Основные поддомены являются наиболее важными, изменчивыми и сложными. Крайне важно, чтобы они были определены как можно точнее, поскольку это позволит убрать из них все универсальные и вспомогательные функции и сконцентрировать усилия на реализации гораздо более ценных функций. 
Избавление от несвойственного может быть несколько смягчено для вспомогательных и универсальных поддоменов. Если дальнейшее углубление в особенности той или иной деятельности не открывает каких-либо новых идей, способных помочь в принятии решений по проектированию программных средств, то, скорее всего, это может стать хорошим знаком для остановки. Такое может, например, случиться, когда все более мелкие поддомены будут относиться к тому же типу, что и исходный поддомен. 
Рассмотрим пример, показанный на рис. 1.4. Дальнейшее выделение поддоменов из справочной службы вряд ли принесет какую-то пользу, поскольку при этом не будет раскрываться никакой стратегической информации, а в качестве решения будет использоваться готовый инструмент общего назначения. 
Еще один важный вопрос, учитываемый при определении поддоменов, заключается в том, нужны ли они все.

![[Рис. 1.4. Выделение поддомена справочной службы с выявлением общих внутренних компонентов.png]]

#### Сосредоточьтесь на главном 
Поддомен является инструментом, облегчающим процесс принятия решений по проектированию программных средств. Вероятно, у всех организаций есть множество бизнес-функций, обеспечивающих их конкурентное преимущество, но не имеющих ничего общего с программным обеспечением. Здесь можно привести в пример ранее рассмотренного нами производителя ювелирных изделий. 
При поиске поддоменов важно определить бизнес-функции, не связанные с программным обеспечением, признать их таковыми и сосредоточиться на тех аспектах бизнеса, которые имеют отношение к программной системе, над которой вы работаете.

## Примеры анализа предметной области 
Давайте посмотрим, как можно применить понятие поддомена на практике и воспользоваться им для принятия ряда стратегических решений. Возьмем две вымышленные компании: Gigmaster и BusVNext. В качестве упражнения во время чтения книги проанализируйте сферы бизнеса компаний. Попробуйте определить три типа поддоменов для каждой компании. И не забывайте, что, как и в реальной жизни, некоторые бизнес-требования носят подразумеваемый характер. 
Разъяснение: разумеется, идентифицировать все поддомены, задействованные в каждой предметной области, на основе краткого описания невозможно. Но все же его вполне достаточно, чтобы научить вас определять и классифицировать доступные поддомены.

### Gigmaster 
Gigmaster — компания по продаже и распространению билетов. В его мобильном приложении, чтобы определить ближайшие шоу, которые пользователи хотели бы посетить, анализируются музыкальные библиотеки пользователей, учетные записи потоковых сервисов и профили в социальных сетях. Пользователи Gigmaster хотят сохранить конфиденциальность. Следовательно, вся личная информация пользователей зашифрована. Более того, для того чтобы тайные увлечения пользователей ни при каких обстоятельствах не просочились наружу, алгоритм рекомендаций компании работает исключительно на обезличенных данных. 
Для повышения качества рекомендаций, выдаваемых приложением, был реализован новый модуль, позволяющий пользователям регистрировать концерты, посещенные в прошлом, даже если билеты были куплены не через Gigmaster.

#### Предметная область (домен) и поддомены 
Сфера деятельности Gigmaster — продажа билетов. Это услуга, предоставляемая компанией клиентам. 
**Основные поддомены.** Главное конкурентное преимущество Gigmaster — система рекомендаций. Компания также серьезно относится к конфиденциальности своих пользователей и работает только с анонимными данными. И наконец, хотя это и не упоминается в явном виде, можно сделать вывод, что впечатления пользователей от мобильного приложения также имеют решающее значение. Таким образом, основными подоменами Gigmaster будут: 
- Система выдачи рекомендаций. 
- Система обеспечения анонимности данных. 
- Мобильное приложение. 
**Универсальные поддомены.** Можно идентифицировать и выделить следующие универсальные поддомены: 
- Шифрования — для шифрования всех данных. 
- Бухгалтерского учета, поскольку компания занимается продажами. 
- Безналичного расчета — для взимания платы с клиентов. 
- Аутентификации и авторизации — для идентификации своих пользователей. 
**Вспомогательные поддомены.** И наконец, вспомогательные поддомены. Здесь бизнес-логика проста и напоминает ETL-процессы или CRUD-интерфейсы: 
- Интеграция с сервисами потоковой передачи музыки. 
- Интеграция с социальными сетями. 
- Модуль посещенных концертов. 

#### Архитектурные решения 
Зная используемые поддомены и различия между их типами, уже можно принять несколько стратегических архитектурных решений: 
- Система выдачи рекомендаций, анонимизация данных и мобильное приложение должны быть реализованы собственными силами с использованием самых передовых технических инструментов и методов. Эти модули будут подвержены наиболее частым изменениям. 
- Для шифрования данных, ведения учетных записей, безналичного расчета и аутентификации следует использовать готовые решения или решения с открытым исходным кодом.
- Интеграция со стриминговыми сервисами и социальными сетями, а также модуль учета посещаемых концертов могут быть переданы на аутсорсинг.

### BusVNext 
BusVNext — компания, работающая в сфере общественного транспорта. Она стремится предоставить своим клиентам поездки в автобусах, не менее комфортабельные, чем поездки в такси. Компания управляет автобусными парками в крупных городах. 
Клиент BusVNext может заказать поездку через мобильное приложение. В запланированное время отправления маршрут ближайшего автобуса будет тут же скорректирован, чтобы забрать клиента точно в указанный срок. 
Основной задачей компании было внедрение алгоритма маршрутизации. Предъявляемые к нему требования являются вариантом «задачи коммивояжера». Логика маршрутизации постоянно корректируется и оптимизируется. Например, статистика показывает, что основной причиной отмены поездок является длительное ожидание прибытия автобуса. Поэтому компания скорректировала алгоритм маршрутизации так, чтобы отдать приоритет быстрым посадкам, даже за счет отсроченных высадок. Чтобы оптимизировать маршрутизацию еще глубже, BusVNext интегрируется со сторонними поставщиками услуг для определения условий трафика и оповещения о них в реальном времени. 
Иногда BusVNext объявляет о специальных скидках, как для привлечения новых клиентов, так и для выравнивания спроса на поездки в часы пик и вне пиковой нагрузки. 

#### Предметная область (домен) и поддомены 
BusVNext предлагает своим клиентам подстроенные под их нужды поездки в автобусе. Сфера деятельности — общественный транспорт. 
**Основные поддомены (core subdomains).** Основным конкурентным преимуществом BusVNext является применяемый компанией алгоритм маршрутизации, нацеленный на решение сложной проблемы («коммивояжер»), с расстановкой приоритетов для различных бизнес-целей: например, для сокращения времени посадки, даже если это увеличит общую продолжительность поездки. 
Также видно, что данные о поездках постоянно анализируются для получения новой информации о поведении клиентов. Эти идеи позволяют компании увеличить свою прибыль за счет оптимизации алгоритма маршрутизации. И наконец, приложения BusVNext для клиентов и водителей должны быть простыми в использовании и иметь удобный пользовательский интерфейс. 
Управление парком — далеко не тривиальная задача. У автобусов могут возникать технические проблемы или же им может потребоваться техническое обслуживание. Игнорирование этих вопросов может привести к финансовым потерям и снижению уровня обслуживания.
Следовательно, основными поддоменами BusVNext будут: 
- Маршрутизация. 
- Аналитика. 
- Пользовательское впечатление от мобильного приложения. 
- Управление автопарком. 
**Универсальные поддомены.** Алгоритмом маршрутизации используются также данные о трафике и оповещения, предоставляемые сторонними компаниями, и это будет универсальным поддоменом. Кроме того, BusVNext принимает платежи от своих клиентов, поэтому компании необходима реализация функции учета и безналичного расчета. Общие поддомены BusVNext: 
- Учет условий трафика. 
- Бухгалтерский учет. 
- Сбор оплаты. 
- Авторизация. 
**Вспомогательные поддомены.** Основному бизнесу компании помогает модуль управления акциями и скидками. Но его как такового отнести к основному поддомену нельзя. Его интерфейс управления можно отнести к простой разновидности CRUD-интерфейса для управления активными кодами купонов. Следовательно, это не что иное, как вспомогательный поддомен. 

#### Архитектурные решения 
Зная используемые поддомены и различия между их типами, можно уже принять ряд стратегических архитектурных решений: 
- Алгоритм маршрутизации, анализ данных, управление автопарком и удобство пользования приложением должны быть реализованы собственными силами с использованием самых сложных технических инструментов и паттернов. 
- Реализация модуля управления рекламными акциями может быть передана на аутсорсинг. 
- Определение условий трафика, авторизация пользователей и управление финансовыми записями и транзакциями могут быть возложены на внешних поставщиков услуг.

## Кто такие специалисты в предметной области? 
Получив четкое представление о предметной области и поддоменах, давайте разберемся с еще одним понятием DDD, которое будет часто использоваться в следующих главах. Речь идет о специалистах в предметной области. Это специалисты, разбирающиеся во всех тонкостях бизнеса, который мы собираемся моделировать и реализовывать в коде. Иными словами, эксперты предметной области являются эрудитами в предметной области разрабатываемого программного обеспечения.
Эксперты в предметной области не являются ни аналитиками, собирающими требования, ни программистами, разрабатывающими систему. Они представляют сам бизнес. Это люди, которые в первую очередь определяют бизнес-задачу и от которых исходят все бизнес-знания. Системные аналитики и программисты трансформируют свои ментальные модели предметной области бизнеса в требования и исходный код. 
Как правило, экспертами предметной области являются либо люди, выдвигающие требования, либо конечные пользователи программного продукта. Их задачи должны быть решены программным продуктом. 
Экспертиза, составленная специалистами в предметной области, может быть разной по объему. Кто-то из экспертов в предметной области будет иметь детальное представление о том, как устроена вся предметная область, а кто-то будет специализироваться на конкретных поддоменах. Например, в рекламном онлайн-агентстве экспертами предметной области могут быть менеджеры кампаний, закупщики медиаконтента, аналитики и другие заинтересованные лица.

## Выводы 
В этой главе были рассмотрены инструменты проектирования, ориентированные на предметную область, предназначенные для понимания деловой активности компании. Было показано, что все начинается с предметной области, т. е. той самой области, в которой работает бизнес, и с услуг, которые он предоставляет своим клиентам. 
Также были обозначены различные строительные блоки, необходимые для достижения успеха в сфере бизнеса и отличия компании от конкурентов: 
**Основные поддомены (core subdomain)**  - Интересные задачи. Деятельность, выполняемая компанией не так, как ее конкурентами, благодаря которой она получает свое конкурентное преимущество. 
**Универсальные поддомены (Generic subdomains)** - Решенные задачи. Это то, что все компании делают одинаково. Здесь нет места инновациям и нет в них никакой необходимости. Вместо создания собственных реализаций более рентабельно будет воспользоваться существующими решениями. 
**Вспомогательные поддомены (Supporting subdomains)** - Задачи с очевидными решениями. Это действия, которые компания, скорее всего, должна будет осуществлять собственными силами, но они не дают никаких конкурентных преимуществ. 

И наконец, было рассказано о том, что специалисты в предметной области являются экспертами в бизнесе. Они обладают глубокими знаниями в предметной области (домене) компании или же в одном или нескольких его поддоменах и играют решающую роль для достижения успеха проекта.