---
updated_at: 2025-12-16T15:31:37.021+10:00
---
**Полный перечень решений, принимаемых в шаблонах скриптов для обработки медиа (расширенный):**

---

### **I. ОБЩИЕ НАСТРОЙКИ**
1. **Приоритет задачи** (`PRIORITY=`) — определение порядка выполнения.
2. **Имя исходного файла** (`FILE=`) — указание входного медиафайла.
3. **Базовое имя выходных файлов** (`OUTBASE=`) — формирование имен результатов.
4. **Корневой путь** (`ROOT=`) — определение корневой директории.
5. **Путь для редактирования** (`EDIT_PATH=`) — директория для сохранения обработанных файлов.
6. **Путь для архивации** (`ARCHIVE_PATH=`) — директория для долгосрочного хранения исходников.
7. **Ревизия** (`REV=`) — суффикс для обозначения версии (например, `_HD`).
8. **Идентификатор аудиодорожки 1** (`AUDIO_OUT1=`) — маркировка первой аудиодорожки.
9. **Идентификатор аудиодорожки 2** (`AUDIO_OUT2=`) — маркировка второй аудиодорожки.
10. **Идентификатор аудиодорожки 3** (`OUT_LANGTAG=`) — маркировка языковой дорожки.

---

### **II. НАСТРОЙКИ ВИДЕО (ПОТОКИ И ПАРАМЕТРЫ)**
11. **Выбор видеопотока** (`[0:v:0]`) — выбор первого видеопотока из входного файла.
12. **Фильтр масштабирования** (`scale=1920:-2`) — приведение к ширине 1920px.
13. **Фильтр добавления чёрных полей** (`pad=1920:1080:-1:-1`) — доведение до разрешения 1920x1080.
14. **Фильтр резкости** (`unsharp=3:3:0.3:3:3:0`) — улучшение чёткости изображения.
15. **Фильтр SAR** (`setsar=1/1`) — установка соотношения сторон пикселей.
16. **Разделение видеопотока** (`split=2[vidHD][inProxy]`) — создание двух видеопотоков.
17. **Создание прокси-видео** (`scale=iw/2:ih`) — уменьшение разрешения в 2 раза.
18. **Кодек видео** (`-c:v libx264`) — использование H.264 для кодирования.
19. **Пресет кодирования видео** (`-preset medium`/`superfast`) — баланс скорость/качество.
20. **Качество видео** (`-crf 16`/`@crf10`) — настройка степени сжатия.
21. **Формат пикселей** (`-pix_fmt yuv420p`) — установка цветового пространства.
22. **Отключение GOP** (`-g 0`) — отключение группировки кадров.
23. **Удаление метаданных видео** (`-map_metadata -1`) — очистка метаданных.
24. **Удаление глав видео** (`-map_chapters -1`) — удаление глав.
25. **Битрейт прокси-видео** (`-b:v 2000k -maxrate 2000k`) — ограничение битрейта.
26. **Опция чересстрочности** (`-x264opts interlaced=1`) — для прокси-видео.
27. **Фильтр децимации** (`decimate=cycle=25`) — удаление лишних кадров.
28. **Коррекция PTS** (`setpts=N/(25*TB)`) — исправление временных меток.
29. **Фильтр FPS** (`fps=25`) — установка частоты кадров.
30. **Наложение субтитров** (`subtitles=...`) — встройка хардсабов.
31. **Стиль субтитров** (`force_style=...`) — задание шрифта, цвета, позиции.

---

### **III. НАСТРОЙКИ АУДИО (ПОТОКИ И ПАРАМЕТРЫ)**
32. **Выбор аудиопотока 1** (`[0:a:0]`) — выбор первой аудиодорожки.
33. **Выбор аудиопотока 2** (`[0:a:1]`) — выбор второй аудиодорожки.
34. **Ресемплинг аудио** (`aresample=48000`) — приведение к частоте 48 кГц.
35. **Коррекция скорости аудио** (`atempo=25/(__)`) — синхронизация с видео.
36. **Разделение аудиопотока** (`asplit=2`) — создание основной и прокси-версии.
37. **Кодек основного аудио** (`-c:a alac`) — использование ALAC для Lossless-сжатия.
38. **Уровень сжатия ALAC** (`-compression_level 0`) — настройка сжатия.
39. **Кодек прокси-аудио** (`-c:a ac3`) — использование AC3 для сжатой версии.
40. **Битрейт прокси-аудио** (`-b:a 128k`) — установка битрейта 128 кбит/с.
41. **Удаление метаданных аудио** (`-map_metadata -1`) — очистка метаданных.
42. **Удаление глав аудио** (`-map_chapters -1`) — удаление глав.
43. **Объединение монофайлов** (`amerge=inputs=6`) — сборка многоканального аудио.
44. **Создание промежуточного аудиопотока** (`[arus_in]`, `[aeng_in]`) — именованные потоки.

---

### **IV. СЛУЖЕБНЫЕ ДЕЙСТВИЯ И УВЕДОМЛЕНИЯ**
45. **Создание директорий** (`mkdir -p`) — подготовка путей для выходных файлов и архива.
46. **Перемещение файла в прогресс** (`mv ... /_IN_PROGRESS/`) — изоляция обрабатываемого файла.
47. **Отправка уведомления о завершении** (`echo ... > /notifications/`) — запись пути к результату.
48. **Формат уведомления** — путь в формате `\\\\nas\\root\\EDIT\\...` или `${EDIT}/...`.
49. **Отложенное перемещение в архив** (`at now + 10 hours`) — перенос исходника в архив через 10 часов.
50. **Создание маркера готовности** (`touch ... .ready`) — файл-флаг завершения обработки.
51. **Очистка терминала** (`clear`) — после каждого шага.
52. **Перемещение скрипта в папку выполненных** (`mv "$0" /_DONE/bash/`) — архивация использованного скрипта.

---

### **V. СПЕЦИАЛЬНЫЕ СЦЕНАРИИ И ЦИКЛЫ**
53. **Обработка трейлеров** — отдельный путь для редактирования и архива.
54. **Обработка серий дорам** (`for ss in {01..99}`) — цикл по сериям, автонумерация.
55. **Формирование имени файла в цикле** (`FILE=${FILEST}${ss}${FILEEND}`) — шаблон имен.
56. **Обработка многоканального аудио из монофайлов** — для фильмов и трейлеров.
57. **Обработка хардсабов** — встройка субтитров на этапе фильтрации видео.
58. **Обработка отдельных монофайлов** — перемещение и обработка 6 отдельных файлов.

---

### **VI. КОМАНДЫ FFMPEG/FFLITE (ОБЩИЕ ПАРАМЕТРЫ)**
59. **Использование `fflite`** — кастомная обёртка над ffmpeg.
60. **Частота кадров** (`-r 25`) — установка частоты кадров для входного файла.
61. **Флаг `-n`** — запрет перезаписи файлов (для дорам).
62. **Входные файлы** (`-i ...`) — указание одного или нескольких входных файлов.
63. **Фильтр-комплекс** (`-filter_complex`) — описание графа обработки.
64. **Маппинг потоков** (`-map "[video]"`, `-map "[audio]"`) — выбор потоков для вывода.
65. **Алиасы кодирования** (`@crf10`, `@alac0`) — предустановленные наборы параметров.

---

### **VII. ПАРАМЕТРЫ ВЫХОДНЫХ ФАЙЛОВ**
66. **Имя основного видеофайла** (`${OUTBASE}${REV}.mp4`) — шаблон имени.
67. **Имя прокси-видео** (`${OUTBASE}${REV}_proxy.mp4`) — шаблон имени.
68. **Имя основного аудиофайла** (`${OUTBASE}${REV}_${AUDIO_OUT1}.m4a`) — шаблон имени.
69. **Имя прокси-аудио** (`${OUTBASE}${REV}_${AUDIO_OUT1}_proxy.ac3`) — шаблон имени.
70. **Имя файла с субтитрами** (`${HSUBFILE}`) — путь к файлу субтитров.

---

### **VIII. ДОПОЛНИТЕЛЬНЫЕ РЕШЕНИЯ**
71. **Использование `clear` в цикле** — очистка экрана после каждой серии.
72. **Перемещение исходных файлов по одному** — для многоканального аудио.
73. **Перемещение исходников в архив сразу** — для трейлеров и отдельных аудио.
74. **Использование `touch` для маркера готовности** — создание файла `.ready`.
75. **Запись уведомления в конкретный файл** (`/home/pemaltynov/IN/notifications/`).
76. **Использование `at` для отложенных задач** — планирование перемещения в архив.
77. **Подстановка параметров в фильтры** (`${FC_AUD}`, `${FC_VID}`) — динамическое формирование команд.
78. **Экранирование спецсимволов в фильтрах** — для параметров субтитров.
79. **Использование переменных в путях** — динамическое формирование путей редактирования.
80. **Цикл с фиксированным диапазоном** (`{01..99}`) — обработка до 99 серий.

---

**Итого: 80 отдельных решений**, охватывающих все аспекты обработки медиа — от выбора потоков и параметров кодирования до служебных действий, уведомлений и циклов. Каждое решение представляет собой отдельный параметр, действие или логический выбор в рамках шаблонов скриптов.