---
updated_at: 2026-02-12T15:17:26.199+10:00
---
**Эфемерность** ({{Disposability|disposability}}) — это свойство [[Process|процесса]] приложения, характеризующее его способность быть быстро запущенным и мгновенно остановленным без потери данных и с минимальным влиянием на общую систему. Эфемерные процессы не требуют длительной инициализации, корректно обрабатывают сигналы завершения и могут быть заменены новыми экземплярами в любой момент без ручного вмешательства.

Термин введён и закреплён методологией [[Twelve-Factor App|Двенадцати факторов]] (девятый фактор) как обязательное свойство облачных приложений.

### Назначение
Эфемерность является необходимым условием для построения отказоустойчивых, эластичных и легко управляемых распределённых систем:

*   **Быстрое масштабирование**. При увеличении нагрузки новые экземпляры процесса должны становиться готовыми к обслуживанию запросов за секунды, а не минуты.
*   **Восстановление после сбоев**. Если процесс аварийно завершается, оркестратор должен немедленно запустить новый экземпляр; время простоя определяется скоростью старта.
*   **Непрерывное развёртывание ([[Continuous Deployment|continuous deployment]])**. Обновление версий выполняется путём остановки старых и запуска новых процессов. Чем быстрее стартует новая версия, тем короче окно простоя при [[Rolling Deployment|rolling deployment]].
*   **Устойчивость к отказам узлов**. В облачных средах физические серверы могут быть остановлены в любой момент; эфемерные процессы могут быть немедленно перезапущены на других узлах без ручного восстановления состояния.
*   **Оптимизация ресурсов**. При снижении нагрузки лишние процессы могут быть быстро остановлены, освобождая вычислительные мощности.

### Ограничения
Обеспечение эфемерности требует архитектурных компромиссов и преодоления ряда препятствий:

1.  **Тяжёлая инициализация ([[Warm-Up|warm-up]])**. Некоторые приложения требуют длительного прогрева: загрузка кэшей, инициализация JIT-компиляторов, установление соединений с внешними сервисами. Сокращение этого времени часто требует значительной инженерной работы.
2.  **Управление состоянием**. Эфемерность возможна только при условии, что процесс не хранит уникальное состояние локально. Все долговременные данные должны выноситься во внешние хранилища.
3.  **Корректное завершение ([[Graceful Shutdown|graceful shutdown]])**. Остановка процесса должна дать ему время завершить текущие запросы, закрыть соединения и освободить ресурсы. Нарушение этого правила ведёт к потере данных и ошибкам у клиентов.
4.  **Сетевые зависимости**. Быстрый старт не может быть достигнут, если процесс ожидает доступности базы данных, брокера сообщений или других сервисов; требуется устойчивость к временной недоступности зависимостей.
5.  **Кэши и локальные данные**. Даже временное кэширование данных на диске или в памяти создаёт зависимость от локального состояния, затрудняя эфемерность.

### Сложившиеся практики
Индустрия выработала устойчивый набор подходов для достижения эфемерности процессов:

1.  **Минимизация времени запуска**. Приложения проектируются так, чтобы инициализация выполнялась максимально быстро. Практики включают:
    *   ленивую загрузку ресурсов (не инициализировать то, что не требуется немедленно);
    *   отказ от тяжёлых фреймворков или предварительная инициализация на этапе сборки образа;
    *   асинхронное установление соединений с зависимостями в фоновом режиме.

2.  **Корректная обработка сигналов ([[Signal|signal handling]])**. Процесс перехватывает сигналы SIGTERM (и аналогичные) и инициирует процедуру [[Graceful Shutdown|graceful shutdown]]:
    *   прекращение приёма новых запросов;
    *   ожидание завершения уже начатых операций в течение таймаута;
    *   закрытие сетевых соединений и дескрипторов;
    *   освобождение ресурсов и завершение процесса.

3.  **Вынесение состояния за пределы процесса**. Все данные, которые должны пережить перезапуск, хранятся во внешних сервисах: базах данных, [[Distributed Cache|распределённых кэшах]] (Redis), объектных хранилищах. Локальная файловая система не используется для долговременного хранения.

4.  **Отказ от локальных кэшей с долгим временем жизни**. Если кэширование необходимо, оно либо выносится в распределённый кэш, либо кэш проектируется как быстро восстанавливаемый (например, загрузка из базы данных при старте).

5.  **[[Health Checks|Проверки готовности (readiness probes)]] и живости (liveness probes)**. В оркестрируемых средах (Kubernetes) процесс должен предоставлять эндпоинты, по которым платформа определяет, готов ли он принимать трафик и не завис ли он. Эфемерный процесс быстро переходит в состояние готовности.

6.  **Статическая компиляция и нативные образы**. Для языков, работающих на виртуальных машинах (Java, C#), применяется AOT-компиляция (GraalVM Native Image, NativeAOT), сокращающая время запуска до десятков миллисекунд. Интерпретируемые языки (Python, Ruby) упаковываются в оптимизированные образы.

7.  **Минимальные контейнерные образы**. Использование дистрибутивов типа Alpine Linux, дистрибулесс-образов (distroless), удаление всех необязательных компонентов сокращает время загрузки образа и запуска контейнера.

8.  **[[Prebaking|Предварительный прогрев (prebaking)]]**. Тяжёлые операции инициализации выполняются на этапе сборки образа, а не при запуске контейнера. Например, компиляция шаблонов, загрузка статических данных, установление соединений, которые могут быть сериализованы.

9.  **Асинхронная инициализация**. Критически важные для первого запроса ресурсы инициализируются синхронно; остальные — в фоновом режиме, не блокируя старт процесса.

10. **Тестирование эфемерности**. В конвейер непрерывной интеграции включаются тесты, проверяющие:
    *   время запуска процесса (не превышает установленный порог);
    *   корректную обработку SIGTERM без потери данных;
    *   способность быстро восстановиться после принудительного завершения.

Таким образом, эфемерность является не просто желательным свойством, а обязательным требованием к современным облачным приложениям. Её систематическое обеспечение требует пересмотра многих устоявшихся практик (долгая инициализация, локальное кэширование, синхронные зависимости), но взамен даёт способность мгновенно реагировать на изменения нагрузки и сбои, что является фундаментом отказоустойчивых и эластичных систем.